{"version":3,"names":["_motionRuntimeTestContext","require","_lodash","_","query","buildRequestTransformation","buildResponseTransformation","preset","describe","test","requestQueryObjectPropertyName","aString","transformationString","expect","toStrictEqual","responseMessageResultPath","responseMessagePagingMetadataPath","times","transformationObject","items","pagingMetadata","itemTransformation"],"sources":["../../../../../src/__tests__/transformations/preset/query-transformation.spec.ts"],"sourcesContent":["import { aString } from '@wix/motion-runtime-test-context';\nimport { times } from 'lodash';\n\nimport { preset } from '../../..';\n\nconst {\n  query: { buildRequestTransformation, buildResponseTransformation },\n} = preset;\n\ndescribe('query-method transformations', () => {\n  describe('buildRequestTransformation', () => {\n    // eslint-disable-next-line max-len\n    test('sets the query object as a property named via requestQueryObjectPropertyName, and spreads the 2nd argument', () => {\n      const requestQueryObjectPropertyName = aString();\n      const transformationString = buildRequestTransformation({\n        requestQueryObjectPropertyName,\n      });\n\n      expect(transformationString).toStrictEqual({\n        [requestQueryObjectPropertyName]: '$[0]',\n        '*': '$[1]',\n      });\n    });\n\n    // eslint-disable-next-line max-len\n    test(\"sets the given query tree under the 'query' property as a default, with the second argument spread into the payload\", () => {\n      const transformationString = buildRequestTransformation();\n\n      expect(transformationString).toStrictEqual({\n        query: '$[0]',\n        '*': '$[1]',\n      });\n    });\n  });\n\n  describe('buildResponseTransformation', () => {\n    const [responseMessageResultPath, responseMessagePagingMetadataPath] =\n      times(2, () => aString());\n\n    test('unwraps the value of the provided property-path', () => {\n      const transformationObject = buildResponseTransformation({\n        responseMessageResultPath,\n        responseMessagePagingMetadataPath,\n      });\n\n      expect(transformationObject).toStrictEqual({\n        items: `$.${responseMessageResultPath}`,\n        pagingMetadata: `$.${responseMessagePagingMetadataPath}`,\n      });\n    });\n\n    test('adds an item-transformation when provided', () => {\n      const itemTransformation = `$.some.path.${aString()}`;\n      const transformationObject = buildResponseTransformation({\n        responseMessageResultPath,\n        responseMessagePagingMetadataPath,\n        itemTransformation,\n      });\n\n      expect(transformationObject).toStrictEqual({\n        items: {\n          '@path': `$.${responseMessageResultPath}`,\n          '@itemTransformation': itemTransformation,\n        },\n        pagingMetadata: `$.${responseMessagePagingMetadataPath}`,\n      });\n    });\n  });\n});\n"],"mappings":";;AAAA,IAAAA,yBAAA,GAAAC,OAAA;AACA,IAAAC,OAAA,GAAAD,OAAA;AAEA,IAAAE,CAAA,GAAAF,OAAA;AAEA,MAAM;EACJG,KAAK,EAAE;IAAEC,0BAA0B;IAAEC;EAA4B;AACnE,CAAC,GAAGC,QAAM;AAEVC,QAAQ,CAAC,8BAA8B,EAAE,MAAM;EAC7CA,QAAQ,CAAC,4BAA4B,EAAE,MAAM;IAC3C;IACAC,IAAI,CAAC,4GAA4G,EAAE,MAAM;MACvH,MAAMC,8BAA8B,GAAG,IAAAC,iCAAO,EAAC,CAAC;MAChD,MAAMC,oBAAoB,GAAGP,0BAA0B,CAAC;QACtDK;MACF,CAAC,CAAC;MAEFG,MAAM,CAACD,oBAAoB,CAAC,CAACE,aAAa,CAAC;QACzC,CAACJ,8BAA8B,GAAG,MAAM;QACxC,GAAG,EAAE;MACP,CAAC,CAAC;IACJ,CAAC,CAAC;;IAEF;IACAD,IAAI,CAAC,qHAAqH,EAAE,MAAM;MAChI,MAAMG,oBAAoB,GAAGP,0BAA0B,CAAC,CAAC;MAEzDQ,MAAM,CAACD,oBAAoB,CAAC,CAACE,aAAa,CAAC;QACzCV,KAAK,EAAE,MAAM;QACb,GAAG,EAAE;MACP,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC,CAAC;EAEFI,QAAQ,CAAC,6BAA6B,EAAE,MAAM;IAC5C,MAAM,CAACO,yBAAyB,EAAEC,iCAAiC,CAAC,GAClE,IAAAC,aAAK,EAAC,CAAC,EAAE,MAAM,IAAAN,iCAAO,EAAC,CAAC,CAAC;IAE3BF,IAAI,CAAC,iDAAiD,EAAE,MAAM;MAC5D,MAAMS,oBAAoB,GAAGZ,2BAA2B,CAAC;QACvDS,yBAAyB;QACzBC;MACF,CAAC,CAAC;MAEFH,MAAM,CAACK,oBAAoB,CAAC,CAACJ,aAAa,CAAC;QACzCK,KAAK,EAAE,KAAKJ,yBAAyB,EAAE;QACvCK,cAAc,EAAE,KAAKJ,iCAAiC;MACxD,CAAC,CAAC;IACJ,CAAC,CAAC;IAEFP,IAAI,CAAC,2CAA2C,EAAE,MAAM;MACtD,MAAMY,kBAAkB,GAAG,eAAe,IAAAV,iCAAO,EAAC,CAAC,EAAE;MACrD,MAAMO,oBAAoB,GAAGZ,2BAA2B,CAAC;QACvDS,yBAAyB;QACzBC,iCAAiC;QACjCK;MACF,CAAC,CAAC;MAEFR,MAAM,CAACK,oBAAoB,CAAC,CAACJ,aAAa,CAAC;QACzCK,KAAK,EAAE;UACL,OAAO,EAAE,KAAKJ,yBAAyB,EAAE;UACzC,qBAAqB,EAAEM;QACzB,CAAC;QACDD,cAAc,EAAE,KAAKJ,iCAAiC;MACxD,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}