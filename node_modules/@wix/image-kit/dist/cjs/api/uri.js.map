{"version":3,"names":["_imageServiceUtils","require","_transforms","_transform","getURI","fittingType","src","target","options","transformObj","isImageTransformApplicable","id","hasAnimation","allowAnimatedTransform","isWEBP","alignment","transformTarget","focalPoint","x","undefined","y","crop","getTransform","getImageURI"],"sources":["../../../src/api/uri.ts"],"sourcesContent":["import {\n  isImageTransformApplicable,\n  isWEBP,\n} from '../helpers/imageServiceUtils';\nimport { getImageURI } from '../engines/transforms';\nimport { getTransform } from './transform';\nimport type {\n  FittingType,\n  ImageTransformObject,\n  ImageTransformOptions,\n  ImageTransformSource,\n  ImageTransformTarget,\n} from '../types';\n\n/**\n * returns image transform uri\n *\n * @param {string}                  fittingType         imageServicesTypes.fittingTypes\n * @param {ImageTransformSource}    src                 source image\n * @param {ImageTransformTarget}    target              target component\n * @param {ImageTransformOptions}   options             transform options\n * @param {Object}                  [transformObj]      transform data object to use\n *\n * @returns {string}\n */\nfunction getURI(\n  fittingType: FittingType,\n  src: ImageTransformSource,\n  target: ImageTransformTarget,\n  options: ImageTransformOptions = {},\n  transformObj?: ImageTransformObject,\n): string {\n  // check if image transformation is applicable (e.g. .gif, .wix_mp)\n  if (\n    isImageTransformApplicable(\n      src.id,\n      options?.hasAnimation,\n      options?.allowAnimatedTransform,\n    )\n  ) {\n    if (isWEBP(src.id)) {\n      // exclude alignment, focalPoint and crop from webp transformation in order not to break webp images before transformation was enabled\n      const { alignment, ...transformTarget } = target;\n      src.focalPoint = { x: undefined, y: undefined };\n      delete src?.crop;\n      transformObj = getTransform(fittingType, src, transformTarget, options);\n    } else {\n      transformObj =\n        transformObj || getTransform(fittingType, src, target, options);\n    }\n\n    // set the uri property\n    return getImageURI(transformObj);\n  }\n\n  return src.id;\n}\n\nexport { getURI };\n"],"mappings":";;;;AAAA,IAAAA,kBAAA,GAAAC,OAAA;AAIA,IAAAC,WAAA,GAAAD,OAAA;AACA,IAAAE,UAAA,GAAAF,OAAA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASG,MAAMA,CACbC,WAAwB,EACxBC,GAAyB,EACzBC,MAA4B,EAC5BC,OAA8B,GAAG,CAAC,CAAC,EACnCC,YAAmC,EAC3B;EACR;EACA,IACE,IAAAC,6CAA0B,EACxBJ,GAAG,CAACK,EAAE,EACNH,OAAO,oBAAPA,OAAO,CAAEI,YAAY,EACrBJ,OAAO,oBAAPA,OAAO,CAAEK,sBACX,CAAC,EACD;IACA,IAAI,IAAAC,yBAAM,EAACR,GAAG,CAACK,EAAE,CAAC,EAAE;MAClB;MACA,MAAM;QAAEI,SAAS;QAAE,GAAGC;MAAgB,CAAC,GAAGT,MAAM;MAChDD,GAAG,CAACW,UAAU,GAAG;QAAEC,CAAC,EAAEC,SAAS;QAAEC,CAAC,EAAED;MAAU,CAAC;MACxCb,GAAG,YAAV,OAAOA,GAAG,CAAEe,IAAI;MAChBZ,YAAY,GAAG,IAAAa,uBAAY,EAACjB,WAAW,EAAEC,GAAG,EAAEU,eAAe,EAAER,OAAO,CAAC;IACzE,CAAC,MAAM;MACLC,YAAY,GACVA,YAAY,IAAI,IAAAa,uBAAY,EAACjB,WAAW,EAAEC,GAAG,EAAEC,MAAM,EAAEC,OAAO,CAAC;IACnE;;IAEA;IACA,OAAO,IAAAe,uBAAW,EAACd,YAAY,CAAC;EAClC;EAEA,OAAOH,GAAG,CAACK,EAAE;AACf","ignoreList":[]}